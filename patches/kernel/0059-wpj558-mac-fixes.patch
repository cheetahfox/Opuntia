--- a/target/linux/ar71xx/files/arch/mips/ath79/mach-wpj558.c
+++ b/target/linux/ar71xx/files/arch/mips/ath79/mach-wpj558.c
@@ -55,27 +55,27 @@
 
 static struct gpio_led wpj558_leds_gpio[] __initdata = {
 	{
-		.name		= "wpj558:red:sig1",
+		.name		= "wpj344:red:sig1",
 		.gpio		= WPJ558_GPIO_LED_SIG1,
 		.active_low	= 1,
 	},
 	{
-		.name		= "wpj558:yellow:sig2",
+		.name		= "wpj344:yellow:sig2",
 		.gpio		= WPJ558_GPIO_LED_SIG2,
 		.active_low	= 1,
 	},
 	{
-		.name		= "wpj558:green:sig3",
+		.name		= "wpj344:green:sig3",
 		.gpio		= WPJ558_GPIO_LED_SIG3,
 		.active_low	= 1,
 	},
 	{
-		.name		= "wpj558:green:sig4",
+		.name		= "wpj344:green:sig4",
 		.gpio		= WPJ558_GPIO_LED_SIG4,
 		.active_low	= 1,
 	},
 	{
-		.name		= "wpj558:buzzer",
+		.name		= "wpj344:buzzer",
 		.gpio		= WPJ558_GPIO_BUZZER,
 		.active_low	= 0,
 	}
@@ -132,8 +132,12 @@ static struct mdio_board_info wpj558_mdi
 	},
 };
 
+extern u8 ath10k_macaddr[ETH_ALEN];
+
 static void __init wpj558_setup(void)
 {
+        struct ath9k_platform_data *pdata;
+	u8 mac[ETH_ALEN];
 	u8 *art = (u8 *) KSEG1ADDR(0x1fff0000);
 
 	ath79_register_m25p80(NULL);
@@ -144,8 +148,16 @@ static void __init wpj558_setup(void)
 					wpj558_gpio_keys);
 
 	ath79_register_usb();
-
-	ath79_register_wmac(art + WPJ558_WMAC_CALDATA_OFFSET, NULL);
+	/* Reserve one for LAN */
+	ath79_init_mac(mac, art + WPJ558_MAC_OFFSET, 3);
+	ath79_register_wmac(art + WPJ558_WMAC_CALDATA_OFFSET, mac);
+	ath79_init_mac(mac, art + WPJ558_MAC_OFFSET, 2);
+	memcpy(ath10k_macaddr, mac, ETH_ALEN);
+	ap91_pci_init(NULL, mac);
+        pdata = ap9x_pci_get_wmac_data(0);
+        if (pdata) {
+        	pdata->use_eeprom = true;
+	}
 
 	ath79_register_pci();
 
@@ -154,7 +166,7 @@ static void __init wpj558_setup(void)
 	ath79_register_mdio(0, 0x0);
 
 	ath79_init_mac(ath79_eth0_data.mac_addr, art + WPJ558_MAC_OFFSET, 0);
-	ath79_init_mac(ath79_eth1_data.mac_addr, art + WPJ558_MAC_OFFSET, 0);
+	ath79_init_mac(ath79_eth1_data.mac_addr, art + WPJ558_MAC_OFFSET, 1);
 
 	ath79_setup_qca955x_eth_cfg(QCA955X_ETH_CFG_RGMII_EN);
 
@@ -163,15 +175,16 @@ static void __init wpj558_setup(void)
 	ath79_eth0_data.phy_mask = BIT(0);
 	ath79_eth0_data.mii_bus_dev = &ath79_mdio0_device.dev;
 	ath79_eth0_pll_data.pll_1000 = 0x56000000;
+	ath79_register_eth(0);
 
+#if 0
 	/* GMAC1 is connected to the SGMII interface */
 	ath79_eth1_data.phy_if_mode = PHY_INTERFACE_MODE_SGMII;
 	ath79_eth1_data.speed = SPEED_1000;
 	ath79_eth1_data.duplex = DUPLEX_FULL;
 	ath79_eth1_pll_data.pll_1000 = 0x03000101;
-
-	ath79_register_eth(0);
 	ath79_register_eth(1);
+#endif
 }
 
 MIPS_MACHINE(ATH79_MACH_WPJ558, "WPJ558", "Compex WPJ558", wpj558_setup);
--- a/target/linux/ar71xx/base-files/lib/upgrade/platform.sh
+++ b/target/linux/ar71xx/base-files/lib/upgrade/platform.sh
@@ -187,7 +187,6 @@ platform_check_image() {
 	hornet-ub | \
 	mr12 | \
 	mr16 | \
-	wpj558 | \
 	zcn-1523h-2 | \
 	zcn-1523h-5)
 		[ "$magic_long" != "68737173" -a "$magic_long" != "19852003" ] && {
@@ -240,6 +239,7 @@ platform_check_image() {
 	wpj531 | \
 	wndap360 | \
 	wpj344 | \
+	wpj558 | \
 	wzr-hp-g300nh2 | \
 	wzr-hp-g300nh | \
 	wzr-hp-g450h | \
--- a/target/linux/ar71xx/base-files/etc/uci-defaults/02_network
+++ b/target/linux/ar71xx/base-files/etc/uci-defaults/02_network
@@ -404,10 +404,12 @@ wpe72)
 	;;
 
 wpj344)
-	ucidef_set_interfaces_lan_wan "eth0.1" "eth0.2"
+	ucidef_set_interfaces_lan_wan "eth0.4001" "eth0.4000"
 	ucidef_add_switch "switch0" "1" "1"
+	ucidef_add_switch_vlan "switch0" "0" "0t 2"
+	uci set network.@switch_vlan[-1].vid='4000'
 	ucidef_add_switch_vlan "switch0" "1" "0t 3"
-	ucidef_add_switch_vlan "switch0" "2" "0t 2"
+	uci set network.@switch_vlan[-1].vid='4001'
 	;;
 
 wpj531)
@@ -415,10 +417,12 @@ wpj531)
 	;;
 
 wpj558)
-	ucidef_set_interfaces_lan_wan "eth0.1" "eth0.2"
+	ucidef_set_interfaces_lan_wan "eth0.4001" "eth0.4000"
 	ucidef_add_switch "switch0" "1" "1"
-	ucidef_add_switch_vlan "switch0" "1" "5 6t"
-	ucidef_add_switch_vlan "switch0" "2" "1 6t"
+	ucidef_add_switch_vlan "switch0" "0" "5 6t"
+	uci set network.@switch_vlan[-1].vid='4000'
+	ucidef_add_switch_vlan "switch0" "1" "1 6t"
+	uci set network.@switch_vlan[-1].vid='4001'
 	;;
 
 ap121 |\
@@ -517,15 +521,6 @@ wndr3700)
 	uci set network.@switch_port[-1].led='2'
 	;;
 
-wpj344)
-	ucidef_set_interfaces_lan_wan "eth0.4001" "eth0.4000"
-	ucidef_add_switch "switch0" "1" "1"
-	ucidef_add_switch_vlan "switch0" "0" "0t 2"
-	uci set network.@switch_vlan[-1].vid='4000'
-	ucidef_add_switch_vlan "switch0" "1" "0t 3"
-	uci set network.@switch_vlan[-1].vid='4001'
-	;;
-
 *)
 	ucidef_set_interfaces_lan_wan "eth0" "eth1"
 	;;
