--- /dev/null
+++ b/package/kernel/mac80211/patches/999-scott-ath10k-set-mac-address-from-wpj344-hack.patch
@@ -0,0 +1,21 @@
+--- a/drivers/net/wireless/ath/ath10k/mac.c	2015-01-09 15:20:12.953989405 -0600
++++ b/drivers/net/wireless/ath/ath10k/mac.c	2015-01-09 15:20:17.981989598 -0600
+@@ -4816,6 +4816,8 @@
+ 	return arvif_iter.arvif;
+ }
+ 
++extern u8 ath10k_macaddr[ETH_ALEN];
++
+ int ath10k_mac_register(struct ath10k *ar)
+ {
+ 	struct ieee80211_supported_band *band;
+@@ -4824,6 +4826,9 @@
+ 	void *channels;
+ 	int ret;
+ 
++        if (ath10k_macaddr)
++                memcpy(ar->mac_addr, ath10k_macaddr, ETH_ALEN);
++
+ 	SET_IEEE80211_PERM_ADDR(ar->hw, ar->mac_addr);
+ 
+ 	SET_IEEE80211_DEV(ar->hw, ar->dev);
--- a/target/linux/ar71xx/files/arch/mips/ath79/mach-wpj344.c
+++ b/target/linux/ar71xx/files/arch/mips/ath79/mach-wpj344.c
@@ -129,8 +129,13 @@ static struct mdio_board_info wpj344_mdi
 	},
 };
 
+u8 ath10k_macaddr[ETH_ALEN];
+EXPORT_SYMBOL_GPL(ath10k_macaddr);
+
 static void __init wpj344_setup(void)
 {
+        struct ath9k_platform_data *pdata;
+	u8 mac[ETH_ALEN];
 	u8 *art = (u8 *) KSEG1ADDR(0x1fff0000);
 
 	ath79_register_m25p80(NULL);
@@ -141,10 +146,16 @@ static void __init wpj344_setup(void)
 					wpj344_gpio_keys);
 
 	ath79_register_usb();
-
-	ath79_register_wmac(art + WPJ344_WMAC_CALDATA_OFFSET, NULL);
-
-	ath79_register_pci();
+	/* Reserve one for LAN */
+	ath79_init_mac(mac, (u8 *) KSEG1ADDR(0x1f02e010) + WPJ344_MAC0_OFFSET, 3);
+	ath79_register_wmac(art + WPJ344_WMAC_CALDATA_OFFSET, mac);
+	ath79_init_mac(mac, (u8 *) KSEG1ADDR(0x1f02e010) + WPJ344_MAC0_OFFSET, 2);
+	memcpy(ath10k_macaddr, mac, ETH_ALEN);
+	ap91_pci_init(NULL, mac);
+        pdata = ap9x_pci_get_wmac_data(0);
+        if (pdata) {
+        	pdata->use_eeprom = true;
+	}
 
 	mdiobus_register_board_info(wpj344_mdio0_info,
 					ARRAY_SIZE(wpj344_mdio0_info));
@@ -152,8 +163,8 @@ static void __init wpj344_setup(void)
 	ath79_register_mdio(1, 0x0);
 	ath79_register_mdio(0, 0x0);
 
-	ath79_init_mac(ath79_eth0_data.mac_addr, art + WPJ344_MAC0_OFFSET, 0);
-	ath79_init_mac(ath79_eth1_data.mac_addr, art + WPJ344_MAC1_OFFSET, 0);
+	ath79_init_mac(ath79_eth0_data.mac_addr, (u8 *) KSEG1ADDR(0x1f02e010) + WPJ344_MAC0_OFFSET, 0);
+	ath79_init_mac(ath79_eth1_data.mac_addr, (u8 *) KSEG1ADDR(0x1f02e010) + WPJ344_MAC0_OFFSET, 1);
 
 	ath79_setup_ar934x_eth_cfg(AR934X_ETH_CFG_RGMII_GMAC0 |
 				   AR934X_ETH_CFG_SW_ONLY_MODE);
@@ -164,13 +175,15 @@ static void __init wpj344_setup(void)
 	ath79_eth0_data.mii_bus_dev = &ath79_mdio0_device.dev;
 	ath79_eth0_pll_data.pll_1000 = 0x06000000;
 
+	ath79_register_eth(0);
+#if 0
 	/* GMAC1 is connected to the internal switch */
 	ath79_eth1_data.phy_if_mode = PHY_INTERFACE_MODE_GMII;
 	ath79_eth1_data.speed = SPEED_1000;
 	ath79_eth1_data.duplex = DUPLEX_FULL;
 
-	ath79_register_eth(0);
 	ath79_register_eth(1);
+#endif
 }
 
 MIPS_MACHINE(ATH79_MACH_WPJ344, "WPJ344", "Compex WPJ344", wpj344_setup);
