From fe8951898741dc2428b8e9268e9f53b599f63178 Mon Sep 17 00:00:00 2001
From: syoder <syoder@imagestream.com>
Date: Mon, 16 Sep 2013 11:08:15 -0500
Subject: [PATCH 08/14] Add 802.11s SAE authentication support in Luci and
 .config

---
 .../luci-mod-admin-full/luasrc/model/cbi/admin_network/wifi.lua  | 17 +++++++++++++++--
 1 file changed, 15 insertions(+), 2 deletions(-)

--- a/modules/luci-mod-admin-full/luasrc/model/cbi/admin_network/wifi.lua
+++ b/modules/luci-mod-admin-full/luasrc/model/cbi/admin_network/wifi.lua
@@ -363,6 +363,15 @@ s:tab("advanced", translate("Advanced Se
 
 ssid = s:taboption("general", Value, "ssid", translate("<abbr title=\"Extended Service Set Identifier\">ESSID</abbr>"))
 ssid.datatype = "maxlength(32)"
+ssid:depends({mode="ap"})
+ssid:depends({mode="sta"})
+ssid:depends({mode="adhoc"})
+ssid:depends({mode="ahdemo"})
+ssid:depends({mode="ap-wds"})
+ssid:depends({mode="sta-wds"})
+
+meshid = s:taboption("general", Value, "mesh_id", translate("<abbr title=\"Mesh Identifier\">Mesh ID</abbr>"))
+meshid:depends({mode="mesh"})
 
 mode = s:taboption("general", ListValue, "mode", translate("Mode"))
 mode.override_values = true
@@ -415,7 +424,7 @@ end
 
 if hwtype == "mac80211" then
 	if fs.access("/usr/sbin/iw") then
-		mode:value("mesh", "802.11s")
+		mode:value("mesh", "802.11s Mesh")
 	end
 
 	mode:value("ahdemo", translate("Pseudo Ad-Hoc (ahdemo)"))
@@ -691,6 +700,10 @@ encr:value("none", "No Encryption")
 encr:value("wep-open",   translate("WEP Open System"), {mode="ap"}, {mode="sta"}, {mode="ap-wds"}, {mode="sta-wds"}, {mode="adhoc"}, {mode="ahdemo"}, {mode="wds"})
 encr:value("wep-shared", translate("WEP Shared Key"),  {mode="ap"}, {mode="sta"}, {mode="ap-wds"}, {mode="sta-wds"}, {mode="adhoc"}, {mode="ahdemo"}, {mode="wds"})
 
+encr:value("authsae", "SAE Authentication", {mode="mesh"})
+key = s:taboption("encryption", Value, "key", translate("<abbr title=\"Key\">Key</abbr>"))
+key:depends({encryption="authsae"})
+
 if hwtype == "atheros" or hwtype == "mac80211" or hwtype == "prism2" then
 	local supplicant = fs.access("/usr/sbin/wpa_supplicant")
 	local hostapd = fs.access("/usr/sbin/hostapd")
